# PocketMark 用户手册

PocketMark 是一款本地存储的 Markdown 知识库应用，强调可控、可迁移与长期沉淀。下面是面向日常使用的操作指南。

## 安装与更新
1. 在 GitHub Releases 下载 `.dmg` 文件。
2. 打开 DMG，将 `PocketMark.app` 拖入 Applications。
3. 首次启动若提示“无法验证开发者”，请右键应用选择“打开”，或在 系统设置 → 隐私与安全 中允许。

更新方式：直接替换 Applications 中的旧版本，笔记数据默认不会受影响（数据保存在独立目录）。

## 界面概览
- 左侧侧边栏：新建、导入、搜索、导航（所有笔记/收藏/今天/工作台/回收站/标签）
- 笔记列表：展示当前筛选下的笔记
- 编辑区：Markdown 编辑与预览，工具栏提供格式化与 AI 功能入口

## 笔记与编辑
- 新建笔记：点击「新建笔记」。
- 自动保存：按设置中的间隔自动保存，可在「设置 → 常规」调整。
- 标题规则：优先使用 frontmatter 中的 `title`，未设置时取正文第一行。
- Markdown 编辑：支持常见语法，工具栏提供粗体、斜体、标题、列表等快捷操作。
- 预览模式：可切换为预览或分屏视图，便于阅读排版结果。

## 导入说明

| 类型 | 说明 | 结果 |
| --- | --- | --- |
| PDF | 提取文本内容 | 生成笔记，并附上原始 PDF 作为附件 |
| DOCX | 转换为 Markdown | 文本转写为 Markdown，图片会作为附件保存 |
| MD | 原样导入 | 保持原始内容与结构 |
| TXT | 纯文本导入 | 自动整理空行与空白 |
| URL | 抓取网页正文 | 使用阅读模式提取正文内容 |
| 音频（MP3/MP4/M4A/WAV） | 语音转写 | 生成转写文本与要点 |

导入流程支持预览，确认后可插入到当前笔记或创建新笔记。

## AI 功能
在「设置 → 高级」中开启 AI，并配置 Base URL / Model / API Key。

常见入口：
- AI 助手面板：总结、标题、标签、问答
- 工作台：大纲、卡片、术语表、行动清单、润色、类比解释
- 选区翻译与配图：选中文本后快速处理
- 语音转写：音频导入时自动转写并生成要点

更详细的功能与配置请参考：`docs/ai-features.md`。

## 多窗口
支持将笔记在新窗口打开，便于对照阅读或多任务编辑。

## 回收站
删除的笔记会进入回收站，可在回收站恢复或批量永久删除。

## 备份与恢复
在「设置 → 备份」中可以：
- 手动创建备份
- 从备份恢复
- 清理旧备份

## 数据位置与迁移
默认根目录：`~/PocketMark`（可在「设置 → 存储」修改）。

目录结构：
- `notes/`：笔记文件
- `notes/assets/`：图片与附件
- `.trash/`：回收站
- `.pocketmark/index.db`：索引数据库
- `.backups/`：备份

修改根目录后，新数据会写入新目录，旧数据不会自动迁移。

## 日志与排障
日志按天写入：
- 目录：`app_log_dir`（macOS 默认 `~/Library/Logs/com.xiaopang.pocketmark/`）
- 文件：`pocketmark-YYYY-MM-DD.log`

日志保留天数可在「设置 → 高级 → 日志保留天数」调整。

如遇卡顿、导入失败或 AI 错误，建议附上对应日期的日志文件以便定位。
